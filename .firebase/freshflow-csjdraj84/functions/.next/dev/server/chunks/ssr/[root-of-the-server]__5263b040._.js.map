{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///Users/dhanarajjayapalan/Development/App/components/OrderHistory.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useState } from 'react';\nimport Image from 'next/image';\nimport { useRouter } from 'next/navigation';\n\nimport type { Order } from '@/lib/items';\n\ninterface OrderHistoryProps {\n    orders: Order[];\n}\n\nexport default function OrderHistory({ orders }: OrderHistoryProps) {\n    const router = useRouter();\n    const [sort, setSort] = useState<'date' | 'items'>('date');\n    const [filter, setFilter] = useState('');\n    const [expandedOrderIds, setExpandedOrderIds] = useState<Set<number>>(new Set());\n\n    const toggleExpand = (orderId: number) => {\n        const next = new Set(expandedOrderIds);\n        if (next.has(orderId)) {\n            next.delete(orderId);\n        } else {\n            next.add(orderId);\n        }\n        setExpandedOrderIds(next);\n    };\n\n    const formatDate = (date: Date) => {\n        return new Intl.DateTimeFormat('en-GB', {\n            day: '2-digit',\n            month: 'short',\n            year: 'numeric',\n            hour: '2-digit',\n            minute: '2-digit',\n            hour12: true\n        }).format(new Date(date));\n    };\n\n    const filteredOrders = orders\n        .filter(o =>\n            o.id.toString().includes(filter) ||\n            formatDate(o.createdAt).toLowerCase().includes(filter.toLowerCase())\n        )\n        .sort((a, b) => {\n            if (sort === 'date') {\n                return new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime();\n            } else {\n                return b.totalItems - a.totalItems;\n            }\n        });\n\n    return (\n        <div className=\"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden\">\n            <div className=\"p-4 border-b border-gray-100 flex gap-4 flex-wrap items-center justify-between bg-gray-50/50\">\n                <h3 className=\"text-lg font-bold text-gray-700\">Order History</h3>\n\n                <div className=\"flex gap-2 flex-1 max-w-sm\">\n                    <input\n                        type=\"text\"\n                        placeholder=\"Filter ID or Date...\"\n                        className=\"bg-white border border-gray-200 text-sm rounded-lg px-3 py-2 flex-1 focus:outline-none focus:ring-2 focus:ring-green-500\"\n                        value={filter}\n                        onChange={(e) => setFilter(e.target.value)}\n                    />\n                    <select\n                        className=\"bg-white border border-gray-200 text-sm rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500\"\n                        value={sort}\n                        onChange={(e) => setSort(e.target.value as 'date' | 'items')}\n                    >\n                        <option value=\"date\">Date</option>\n                        <option value=\"items\">Items</option>\n                    </select>\n                </div>\n            </div>\n\n            <div className=\"block w-full overflow-x-auto\">\n                <table className=\"items-center w-full bg-transparent border-collapse\">\n                    <thead>\n                        <tr>\n                            <th className=\"px-6 align-middle border border-solid py-3 text-xs uppercase border-l-0 border-r-0 whitespace-nowrap font-semibold text-left bg-gray-50 text-gray-500 border-gray-100 w-16\">\n                                {/* Expand Toggle */}\n                            </th>\n                            <th className=\"px-6 align-middle border border-solid py-3 text-xs uppercase border-l-0 border-r-0 whitespace-nowrap font-semibold text-left bg-gray-50 text-gray-500 border-gray-100\">\n                                Order ID\n                            </th>\n                            <th className=\"px-6 align-middle border border-solid py-3 text-xs uppercase border-l-0 border-r-0 whitespace-nowrap font-semibold text-left bg-gray-50 text-gray-500 border-gray-100\">\n                                Created\n                            </th>\n                            <th className=\"px-6 align-middle border border-solid py-3 text-xs uppercase border-l-0 border-r-0 whitespace-nowrap font-semibold text-left bg-gray-50 text-gray-500 border-gray-100\">\n                                Total Items\n                            </th>\n                            <th className=\"px-6 align-middle border border-solid py-3 text-xs uppercase border-l-0 border-r-0 whitespace-nowrap font-semibold text-left bg-gray-50 text-gray-500 border-gray-100\">\n                                Updated\n                            </th>\n                            <th className=\"px-6 align-middle border border-solid py-3 text-xs uppercase border-l-0 border-r-0 whitespace-nowrap font-semibold text-left bg-gray-50 text-gray-500 border-gray-100\">\n                                Action\n                            </th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {filteredOrders.length === 0 ? (\n                            <tr>\n                                <td colSpan={6} className=\"text-center p-8 text-gray-400 italic\">No orders found.</td>\n                            </tr>\n                        ) : (\n                            filteredOrders.map((order) => {\n                                const isExpanded = expandedOrderIds.has(order.id);\n\n                                return (\n                                    <React.Fragment key={order.id}>\n                                        <tr className=\"hover:bg-gray-50/50 transition-colors border-b last:border-0 border-gray-100 cursor-pointer\" onClick={() => toggleExpand(order.id)}>\n                                            <td className=\"border-t-0 px-6 align-middle border-l-0 border-r-0 text-xs whitespace-nowrap p-4 text-center\">\n                                                <svg className={`w-4 h-4 text-gray-400 transition-transform ${isExpanded ? 'rotate-90' : ''}`} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M9 5l7 7-7 7\" />\n                                                </svg>\n                                            </td>\n                                            <td className=\"border-t-0 px-6 align-middle border-l-0 border-r-0 text-xs whitespace-nowrap p-4 text-left font-bold text-gray-700\">\n                                                #{order.id}\n                                            </td>\n                                            <td className=\"border-t-0 px-6 align-middle border-l-0 border-r-0 text-xs whitespace-nowrap p-4 text-gray-600\">\n                                                {formatDate(order.createdAt)}\n                                            </td>\n                                            <td className=\"border-t-0 px-6 align-middle border-l-0 border-r-0 text-xs whitespace-nowrap p-4\">\n                                                <span className=\"bg-green-100 text-green-700 py-1 px-3 rounded-full font-bold text-xs\">\n                                                    {order.totalItems} items\n                                                </span>\n                                            </td>\n                                            <td className=\"border-t-0 px-6 align-middle border-l-0 border-r-0 text-xs whitespace-nowrap p-4 text-gray-600\">\n                                                {formatDate(order.updatedAt)}\n                                            </td>\n                                            <td className=\"border-t-0 px-6 align-middle border-l-0 border-r-0 text-xs whitespace-nowrap p-4\" onClick={(e) => e.stopPropagation()}>\n                                                <div className=\"flex gap-2 items-center\">\n                                                    <button\n                                                        onClick={() => router.push(`/select?orderId=${order.id}`)}\n                                                        className=\"bg-green-600 hover:bg-green-700 text-white font-bold py-1.5 px-3 rounded-lg text-xs transition-all hover:scale-105 shadow-md flex items-center gap-1.5\"\n                                                    >\n                                                        <svg className=\"w-3.5 h-3.5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                                                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\" />\n                                                        </svg>\n                                                        Edit\n                                                    </button>\n                                                    <button\n                                                        onClick={async () => {\n                                                            if (confirm(`âš ï¸ Delete order #${order.id}?\\n\\nThis will permanently delete this order and all its items. This action cannot be undone.`)) {\n                                                                const { deleteOrder } = await import('@/app/actions/order');\n                                                                const result = await deleteOrder(order.id);\n                                                                if (result.success) {\n                                                                    window.location.reload();\n                                                                } else {\n                                                                    alert('Failed to delete order. Please try again.');\n                                                                }\n                                                            }\n                                                        }}\n                                                        className=\"bg-red-600 hover:bg-red-700 text-white font-bold py-1.5 px-3 rounded-lg text-xs transition-all hover:scale-105 shadow-md flex items-center gap-1.5\"\n                                                        title=\"Delete this order permanently\"\n                                                    >\n                                                        <svg className=\"w-3.5 h-3.5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                                                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\n                                                        </svg>\n                                                        Delete\n                                                    </button>\n                                                </div>\n                                            </td>\n                                        </tr>\n                                        {isExpanded && (\n                                            <tr className=\"bg-gray-50/30\">\n                                                <td colSpan={6} className=\"p-4 border-b border-gray-100\">\n                                                    <div className=\"bg-white rounded-xl p-4 shadow-inner border border-gray-100\">\n                                                        <h4 className=\"font-semibold text-gray-700 mb-3 text-sm\">Order Contents</h4>\n                                                        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3\">\n                                                            {order.items?.map((item) => (\n                                                                <div key={item.id} className=\"flex items-center gap-3 p-2 rounded-lg bg-gray-50 border border-gray-100\">\n                                                                    <div className=\"w-10 h-10 bg-white rounded-md border border-gray-200 flex items-center justify-center overflow-hidden shrink-0\">\n                                                                        {item.item?.imageUrl ? (\n                                                                            <Image\n                                                                                src={item.item.imageUrl}\n                                                                                alt={item.itemName}\n                                                                                width={40}\n                                                                                height={40}\n                                                                                className=\"w-full h-full object-cover\"\n                                                                            />\n                                                                        ) : (\n                                                                            <span className=\"text-xl\">ðŸ“¦</span>\n                                                                        )}\n                                                                    </div>\n                                                                    <div className=\"flex-1 min-w-0\">\n                                                                        <p className=\"text-sm font-medium text-gray-800 truncate\" title={item.itemName}>{item.itemName}</p>\n                                                                        <p className=\"text-xs text-gray-500\">Qty: {item.quantity}</p>\n                                                                    </div>\n                                                                </div>\n                                                            ))}\n                                                        </div>\n                                                    </div>\n                                                </td>\n                                            </tr>\n                                        )}\n                                    </React.Fragment>\n                                );\n                            })\n                        )}\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}}]
}