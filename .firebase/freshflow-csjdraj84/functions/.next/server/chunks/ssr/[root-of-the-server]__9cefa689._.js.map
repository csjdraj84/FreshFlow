{"version":3,"sources":["../../../../.next-internal/server/app/select/page/actions.js%20%28server%20actions%20loader%29","../../../../app/actions/items.ts"],"sourcesContent":["export {getOrders as '003df157ada4962c46e438cb8aa409fffff9333f91'} from 'ACTIONS_MODULE0'\nexport {deleteOrder as '408dd28efab749e8ec0207f2a76ec39217c0e0c1b0'} from 'ACTIONS_MODULE0'\nexport {getOrder as '40a2c10035d67a6ac16a3267e557e0d18b0f5decd3'} from 'ACTIONS_MODULE0'\nexport {saveOrder as '604f800e84172abc8e56fe61564b7bbabd91705da9'} from 'ACTIONS_MODULE0'\nexport {addItem as '40e77819eef9e467b67a8f576cd66912b41758e37b'} from 'ACTIONS_MODULE1'\nexport {saveOrder as '604f800e84172abc8e56fe61564b7bbabd91705da9'} from 'ACTIONS_MODULE0'\n","\"use server\";\n\nimport { prisma } from '@/lib/items';\nimport { revalidatePath } from 'next/cache';\n\nimport { writeFile } from 'fs/promises';\nimport { join } from 'path';\n\nexport async function addItem(formData: FormData) {\n    const name = formData.get('name') as string;\n    const tamilName = formData.get('tamilName') as string;\n    const image = formData.get('image') as File;\n\n    if (!name) return;\n\n    let imagePath = null;\n\n    if (image && image.size > 0) {\n        try {\n            const bytes = await image.arrayBuffer();\n            const buffer = Buffer.from(bytes);\n\n            // Create safe filename\n            const safeName = name.toLowerCase().replace(/[^a-z0-9]/g, '_');\n            const extension = image.name.split('.').pop() || 'jpg';\n            const filename = `${safeName}_${Date.now()}.${extension}`;\n\n            // Save to public/images/products\n            const uploadDir = join(process.cwd(), 'public', 'images', 'products');\n            const filePath = join(uploadDir, filename);\n\n            await writeFile(filePath, buffer);\n            imagePath = `/images/products/${filename}`;\n        } catch (error) {\n            console.error(\"Error saving image:\", error);\n            // Continue creating item without image if upload fails? \n            // Or throw? Let's log and continue for now.\n        }\n    }\n\n    try {\n        await prisma.item.create({\n            data: {\n                name,\n                tamilName: tamilName || null,\n                imagePath: imagePath\n            }\n        });\n        revalidatePath('/select');\n    } catch (e) {\n        console.error(\"Failed to add item:\", e);\n        return { error: \"Failed to add item\" };\n    }\n}\n"],"names":[],"mappings":"gHAAA,IAAA,EAAA,EAAA,CAAA,CAAA,kBCEA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAEA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAEO,eAAe,EAAQ,CAAkB,EAC5C,IAAM,EAAO,EAAS,GAAG,CAAC,QACpB,EAAY,EAAS,GAAG,CAAC,aACzB,EAAQ,EAAS,GAAG,CAAC,SAE3B,GAAI,CAAC,EAAM,OAEX,IAAI,EAAY,KAEhB,GAAI,GAAS,EAAM,IAAI,CAAG,EACtB,CADyB,EACrB,CACA,IAAM,EAAQ,MAAM,EAAM,WAAW,GAC/B,EAAS,OAAO,IAAI,CAAC,GAGrB,EAAW,EAAK,WAAW,GAAG,OAAO,CAAC,aAAc,KACpD,EAAY,EAAM,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG,IAAM,MAC3C,EAAW,CAAA,EAAG,EAAS,CAAC,EAAE,KAAK,GAAG,GAAG,CAAC,EAAE,EAAA,CAAW,CAGnD,EAAY,CAAA,EAAA,EAAA,IAAA,AAAI,EAAC,QAAQ,GAAG,GAAI,SAAU,SAAU,YACpD,EAAW,CAAA,EAAA,EAAA,IAAA,AAAI,EAAC,EAAW,EAEjC,OAAM,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,EAAU,GAC1B,EAAY,CAAC,iBAAiB,EAAE,EAAA,CAAU,AAC9C,CAAE,MAAO,EAAO,CACZ,QAAQ,KAAK,CAAC,sBAAuB,EAGzC,CAGJ,GAAI,CACA,MAAM,EAAA,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CACrB,KAAM,MACF,EACA,UAAW,GAAa,KACxB,UAAW,CACf,CACJ,GACA,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,UACnB,CAAE,MAAO,EAAG,CAER,OADA,QAAQ,KAAK,CAAC,sBAAuB,GAC9B,CAAE,MAAO,oBAAqB,CACzC,CACJ,0CA7CsB,IAAA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA"}